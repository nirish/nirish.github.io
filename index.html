<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #8cd3fe; -webkit-text-stroke: #8cd3fe}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #c27e65; -webkit-text-stroke: #c27e65}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca; min-height: 16.0px}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d7378; -webkit-text-stroke: #6d7378}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #71c083; -webkit-text-stroke: #71c083}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #36c0a0; -webkit-text-stroke: #36c0a0}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #d4d4d4; -webkit-text-stroke: #d4d4d4}
    p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #b76ff7; -webkit-text-stroke: #b76ff7}
    span.s1 {font-kerning: none; background-color: #171818}
    span.s2 {font-kerning: none; color: #8cd3fe; background-color: #171818; -webkit-text-stroke: 0px #8cd3fe}
    span.s3 {font-kerning: none; color: #6d6d6d; background-color: #171818; -webkit-text-stroke: 0px #6d6d6d}
    span.s4 {font-kerning: none; color: #cacaca; background-color: #171818; -webkit-text-stroke: 0px #cacaca}
    span.s5 {font-kerning: none; color: #c27e65; background-color: #171818; -webkit-text-stroke: 0px #c27e65}
    span.s6 {font-kerning: none; color: #4689cc; background-color: #171818; -webkit-text-stroke: 0px #4689cc}
    span.s7 {font-kerning: none}
    span.s8 {font-kerning: none; color: #d4d4d4; background-color: #171818; -webkit-text-stroke: 0px #d4d4d4}
    span.s9 {font-kerning: none; color: #71c083; background-color: #171818; -webkit-text-stroke: 0px #71c083}
    span.s10 {font-kerning: none; color: #b76ff7; background-color: #171818; -webkit-text-stroke: 0px #b76ff7}
    span.s11 {font-kerning: none; color: #36c0a0; background-color: #171818; -webkit-text-stroke: 0px #36c0a0}
    span.s12 {font-kerning: none; color: #6d7378; background-color: #171818; -webkit-text-stroke: 0px #6d7378}
    span.s13 {font-kerning: none; color: #f67c30; background-color: #171818; -webkit-text-stroke: 0px #f67c30}
    span.s14 {font-kerning: none; color: #ee2e38; background-color: #171818; -webkit-text-stroke: 0px #ee2e38}
  </style>
    <script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyD92lDT-pbCB-EmtnTaEUhyql-CCYsLhho",
    authDomain: "dram-50c7c.firebaseapp.com",
    projectId: "dram-50c7c",
    storageBucket: "dram-50c7c.firebasestorage.app",
    messagingSenderId: "645616473221",
    appId: "1:645616473221:web:3a79dd9a2313f01bd0c5ec",
    measurementId: "G-VL3RYR0YRD"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
</script>
</head>
  
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"en"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">Daily Dram Tracker PWA</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- 1. PWA Manifest Link --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"manifest"</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"/manifest.json"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- 2. Apple Specific Tags for iOS Home Screen --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"apple-mobile-web-app-capable"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"yes"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"apple-mobile-web-app-status-bar-style"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"black"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"apple-mobile-web-app-title"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"Dram Tracker"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Theme Color for Browser/OS UI --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"theme-color"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"#065f46"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Load Tailwind CSS --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Load React Libraries --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.development.js"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.development.js"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Load Babel for JSX Transpilation --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://unpkg.com/@babel/standalone/babel.min.js"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Load Lucide Icons for React Components --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://unpkg.com/lucide@latest"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Configure Tailwind to allow custom colors and Inter font --&gt;</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>tailwind</span><span class="s8">.</span><span class="s1">config </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>theme</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>extend</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>fontFamily</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>sans</span><span class="s8">:</span><span class="s1"> </span><span class="s8">[</span><span class="s9">'Inter'</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'sans-serif'</span><span class="s8">],</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>colors</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">'emerald-800'</span><span class="s8">:</span><span class="s1"> </span><span class="s9">'#065f46'</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">'emerald-600'</span><span class="s8">:</span><span class="s1"> </span><span class="s9">'#059669'</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">'amber-500'</span><span class="s8">:</span><span class="s1"> </span><span class="s9">'#f59e0b'</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-50"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"root"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- 3. Register Service Worker --&gt;</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(</span><span class="s9">'serviceWorker'</span><span class="s1"> </span><span class="s10">in</span><span class="s1"> navigator</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>window</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'load'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>navigator</span><span class="s8">.</span><span class="s1">serviceWorker</span><span class="s8">.</span><span class="s1">register</span><span class="s8">(</span><span class="s9">'/service-worker.js'</span><span class="s8">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">.</span><span class="s1">then</span><span class="s8">(</span><span class="s1">registration </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>console</span><span class="s8">.</span><span class="s1">log</span><span class="s8">(</span><span class="s9">'SW registered:'</span><span class="s8">,</span><span class="s1"> registration</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">})</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">.</span><span class="s10">catch</span><span class="s8">(</span><span class="s1">error </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s9">'SW registration failed:'</span><span class="s8">,</span><span class="s1"> error</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- 4. Load Firebase Libraries (Need to be loaded before your React code uses them) --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"module"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s10">import</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> initializeApp </span><span class="s8">}</span><span class="s4"> </span><span class="s10">from</span><span class="s4"> </span><span class="s1">"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">import</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> getAuth</span><span class="s8">,</span><span class="s1"> signInWithCustomToken</span><span class="s8">,</span><span class="s1"> signInAnonymously</span><span class="s8">,</span><span class="s1"> onAuthStateChanged </span><span class="s8">}</span><span class="s1"> </span><span class="s10">from</span><span class="s1"> </span><span class="s9">"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">import</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> getFirestore</span><span class="s8">,</span><span class="s1"> doc</span><span class="s8">,</span><span class="s1"> setDoc</span><span class="s8">,</span><span class="s1"> collection</span><span class="s8">,</span><span class="s1"> query</span><span class="s8">,</span><span class="s1"> onSnapshot</span><span class="s8">,</span><span class="s1"> getDocs</span><span class="s8">,</span><span class="s1"> deleteDoc </span><span class="s8">}</span><span class="s1"> </span><span class="s10">from</span><span class="s1"> </span><span class="s9">"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Attach Firebase functions to the window object so your JSX component can access them.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s8">.</span><span class="s1">firebase </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> initializeApp</span><span class="s8">,</span><span class="s1"> getAuth</span><span class="s8">,</span><span class="s1"> signInWithCustomToken</span><span class="s8">,</span><span class="s1"> signInAnonymously</span><span class="s8">,</span><span class="s1"> onAuthStateChanged</span><span class="s8">,</span><span class="s1"> getFirestore</span><span class="s8">,</span><span class="s1"> doc</span><span class="s8">,</span><span class="s1"> setDoc</span><span class="s8">,</span><span class="s1"> collection</span><span class="s8">,</span><span class="s1"> query</span><span class="s8">,</span><span class="s1"> onSnapshot</span><span class="s8">,</span><span class="s1"> getDocs</span><span class="s8">,</span><span class="s1"> deleteDoc </span><span class="s8">};</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// This is a placeholder for your Firebase config.<span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// YOU MUST REPLACE THESE VARIABLES WITH YOUR ACTUAL FIREBASE PROJECT CONFIG AND AUTH LOGIC<span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// if you move this outside the current Canvas environment.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s8">.</span><span class="s1">__app_id </span><span class="s8">=</span><span class="s1"> </span><span class="s9">"your-app-id-if-needed"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s8">.</span><span class="s1">__firebase_config </span><span class="s8">=</span><span class="s1"> </span><span class="s11">JSON</span><span class="s8">.</span><span class="s1">stringify</span><span class="s8">({});</span><span class="s1"> </span><span class="s12">// Your actual config object goes here</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s8">.</span><span class="s1">__initial_auth_token </span><span class="s8">=</span><span class="s1"> </span><span class="s10">null</span><span class="s8">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- 5. Load and Transpile Your React Component (DrinkTracker.jsx content goes here) --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text/babel"</span><span class="s4"> </span><span class="s2">data-type</span><span class="s3">=</span><span class="s1">"module"</span><span class="s4"> </span><span class="s2">data-presets</span><span class="s3">=</span><span class="s1">"react"</span><span class="s4"> </span><span class="s2">data-filename</span><span class="s3">=</span><span class="s1">"/DrinkTracker.jsx"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s10">import</span><span class="s1"> </span><span class="s11">React</span><span class="s8">,</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> useState</span><span class="s8">,</span><span class="s1"> useEffect</span><span class="s8">,</span><span class="s1"> useMemo</span><span class="s8">,</span><span class="s1"> useCallback </span><span class="s8">}</span><span class="s1"> </span><span class="s10">from</span><span class="s1"> </span><span class="s9">'react'</span><span class="s8">;</span></p>
<p class="p4"><span class="s10">import</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> initializeApp </span><span class="s8">}</span><span class="s1"> </span><span class="s10">from</span><span class="s1"> </span><span class="s9">'firebase/app'</span><span class="s8">;</span></p>
<p class="p4"><span class="s10">import</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> getAuth</span><span class="s8">,</span><span class="s1"> signInWithCustomToken</span><span class="s8">,</span><span class="s1"> signInAnonymously</span><span class="s8">,</span><span class="s1"> onAuthStateChanged </span><span class="s8">}</span><span class="s1"> </span><span class="s10">from</span><span class="s1"> </span><span class="s9">'firebase/auth'</span><span class="s8">;</span></p>
<p class="p4"><span class="s10">import</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> getFirestore</span><span class="s8">,</span><span class="s1"> doc</span><span class="s8">,</span><span class="s1"> setDoc</span><span class="s8">,</span><span class="s1"> collection</span><span class="s8">,</span><span class="s1"> query</span><span class="s8">,</span><span class="s1"> onSnapshot</span><span class="s8">,</span><span class="s1"> getDocs</span><span class="s8">,</span><span class="s1"> deleteDoc </span><span class="s8">}</span><span class="s1"> </span><span class="s10">from</span><span class="s1"> </span><span class="s9">'firebase/firestore'</span><span class="s8">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p8"><span class="s10">import</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s1">Wine</span><span class="s8">,</span><span class="s4"> </span><span class="s1">CalendarCheck</span><span class="s8">,</span><span class="s4"> </span><span class="s1">Zap</span><span class="s8">,</span><span class="s4"> </span><span class="s1">Goal</span><span class="s8">,</span><span class="s4"> </span><span class="s1">Flame</span><span class="s8">,</span><span class="s4"> </span><span class="s1">Calculator</span><span class="s8">,</span><span class="s4"> </span><span class="s1">ChevronDown</span><span class="s8">,</span><span class="s4"> </span><span class="s1">ChevronUp</span><span class="s8">,</span><span class="s4"> </span><span class="s1">Trash2</span><span class="s8">,</span><span class="s4"> </span><span class="s1">Minus</span><span class="s8">,</span><span class="s4"> </span><span class="s1">Plus</span><span class="s4"> </span><span class="s8">}</span><span class="s4"> </span><span class="s10">from</span><span class="s4"> </span><span class="s9">'lucide-react'</span><span class="s8">;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s1">// --- Global Constants &amp; Firebase Setup ---</span></p>
<p class="p6"><span class="s1">// These variables are provided by the canvas environment.</span></p>
<p class="p4"><span class="s10">const</span><span class="s1"> appId </span><span class="s8">=</span><span class="s1"> </span><span class="s10">typeof</span><span class="s1"> __app_id </span><span class="s8">!==</span><span class="s1"> </span><span class="s9">'undefined'</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> __app_id </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'default-app-id'</span><span class="s8">;</span></p>
<p class="p4"><span class="s10">const</span><span class="s1"> firebaseConfig </span><span class="s8">=</span><span class="s1"> </span><span class="s10">typeof</span><span class="s1"> __firebase_config </span><span class="s8">!==</span><span class="s1"> </span><span class="s9">'undefined'</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s11">JSON</span><span class="s8">.</span><span class="s1">parse</span><span class="s8">(</span><span class="s1">__firebase_config</span><span class="s8">)</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s8">{};</span></p>
<p class="p4"><span class="s10">const</span><span class="s1"> initialAuthToken </span><span class="s8">=</span><span class="s1"> </span><span class="s10">typeof</span><span class="s1"> __initial_auth_token </span><span class="s8">!==</span><span class="s1"> </span><span class="s9">'undefined'</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> __initial_auth_token </span><span class="s8">:</span><span class="s1"> </span><span class="s10">null</span><span class="s8">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s1">// The base constants for your tracking goals</span></p>
<p class="p6"><span class="s10">const</span><span class="s4"> </span><span class="s11">DAYS_IN_SABBATICAL</span><span class="s4"> </span><span class="s8">=</span><span class="s4"> </span><span class="s13">107</span><span class="s8">;</span><span class="s4"> </span><span class="s1">// Sabbatical runs up to and including this day of the year (Day 107).</span></p>
<p class="p6"><span class="s10">const</span><span class="s4"> </span><span class="s11">SABBATICAL_END_WEEK</span><span class="s4"> </span><span class="s8">=</span><span class="s4"> </span><span class="s13">15</span><span class="s8">;</span><span class="s4"> </span><span class="s1">// Week 1 to Week 15 is the sabbatical period (approximate based on DOY 107)</span></p>
<p class="p8"><span class="s10">const</span><span class="s4"> </span><span class="s1">TOTAL_TRACKING_WEEKS</span><span class="s4"> </span><span class="s8">=</span><span class="s4"> </span><span class="s13">37</span><span class="s8">;</span></p>
<p class="p8"><span class="s10">const</span><span class="s4"> </span><span class="s1">DRINK_VOLUME_ML</span><span class="s4"> </span><span class="s8">=</span><span class="s4"> </span><span class="s13">45</span><span class="s8">;</span><span class="s4"> </span><span class="s12">// 1 dram/drink</span></p>
<p class="p8"><span class="s10">const</span><span class="s4"> </span><span class="s1">BOTTLE_VOLUME_ML</span><span class="s4"> </span><span class="s8">=</span><span class="s4"> </span><span class="s13">750</span><span class="s8">;</span></p>
<p class="p8"><span class="s10">const</span><span class="s4"> </span><span class="s1">DEFAULT_GOAL</span><span class="s4"> </span><span class="s8">=</span><span class="s4"> </span><span class="s13">1.8</span><span class="s8">;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s1">// Utility to ensure two decimal places</span></p>
<p class="p4"><span class="s10">const</span><span class="s1"> round </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">num</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s11">Math</span><span class="s8">.</span><span class="s1">round</span><span class="s8">(</span><span class="s1">num </span><span class="s8">*</span><span class="s1"> </span><span class="s13">100</span><span class="s8">)</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> </span><span class="s13">100</span><span class="s8">;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s1">// Calculates the Day of the Year (1-365/366) for a given date.</span></p>
<p class="p6"><span class="s1">// IMPORTANT: Uses UTC component getters to ignore local timezone offset (like PST)<span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s1">// and ensure the DOY calculation matches the physical date selected.</span></p>
<p class="p4"><span class="s10">const</span><span class="s1"> getDayOfYear </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">date</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s1">// Use the UTC midnight date components for consistent DOY calculation</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s10">const</span><span class="s1"> dateUTC </span><span class="s8">=</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(</span><span class="s11">Date</span><span class="s8">.</span><span class="s11">UTC</span><span class="s8">(</span><span class="s1">date</span><span class="s8">.</span><span class="s1">getUTCFullYear</span><span class="s8">(),</span><span class="s1"> date</span><span class="s8">.</span><span class="s1">getUTCMonth</span><span class="s8">(),</span><span class="s1"> date</span><span class="s8">.</span><span class="s1">getUTCDate</span><span class="s8">()));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s10">const</span><span class="s1"> startOfYear </span><span class="s8">=</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(</span><span class="s11">Date</span><span class="s8">.</span><span class="s11">UTC</span><span class="s8">(</span><span class="s1">dateUTC</span><span class="s8">.</span><span class="s1">getUTCFullYear</span><span class="s8">(),</span><span class="s1"> </span><span class="s13">0</span><span class="s8">,</span><span class="s1"> </span><span class="s13">1</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s10">const</span><span class="s1"> diff </span><span class="s8">=</span><span class="s1"> dateUTC</span><span class="s8">.</span><span class="s1">getTime</span><span class="s8">()</span><span class="s1"> </span><span class="s8">-</span><span class="s1"> startOfYear</span><span class="s8">.</span><span class="s1">getTime</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s10">const</span><span class="s1"> oneDay </span><span class="s8">=</span><span class="s1"> </span><span class="s13">1000</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">60</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">60</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">24</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s10">return</span><span class="s1"> </span><span class="s11">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s1">diff </span><span class="s8">/</span><span class="s1"> oneDay</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s13">1</span><span class="s8">;</span></p>
<p class="p9"><span class="s1">};</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s1">// Calculates the chronological calendar week number (1-53) based on Day of Year.</span></p>
<p class="p4"><span class="s10">const</span><span class="s1"> getCalendarWeek </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">date</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> doy </span><span class="s8">=</span><span class="s1"> getDayOfYear</span><span class="s8">(</span><span class="s1">date</span><span class="s8">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// Use Friday-Thursday week start, Week 1 starts with the week containing Jan 1</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// This is a simple approximation; a more complex ISO week rule is often used</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// but this suffices for consistent chronological numbering.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">return</span><span class="s1"> </span><span class="s11">Math</span><span class="s8">.</span><span class="s1">min</span><span class="s8">(</span><span class="s11">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">((</span><span class="s1">doy </span><span class="s8">-</span><span class="s1"> </span><span class="s13">1</span><span class="s8">)</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> </span><span class="s13">7</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s13">1</span><span class="s8">,</span><span class="s1"> </span><span class="s13">53</span><span class="s8">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p9"><span class="s1">};</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s1">// Calculates the number of tracking weeks that have elapsed since the sabbatical ended, based on a specific date.</span></p>
<p class="p6"><span class="s1">// Tracking starts on Day 108 (approx Week 16). The elapsed weeks is simply the current week number minus the sabbatical end week.</span></p>
<p class="p4"><span class="s10">const</span><span class="s1"> getElapsedTrackingWeeks </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">date</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s10">const</span><span class="s1"> doy </span><span class="s8">=</span><span class="s1"> getDayOfYear</span><span class="s8">(</span><span class="s1">date</span><span class="s8">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s10">if</span><span class="s4"> </span><span class="s8">(</span><span class="s4">doy </span><span class="s8">&lt;=</span><span class="s4"> </span><span class="s11">DAYS_IN_SABBATICAL</span><span class="s8">)</span><span class="s4"> </span><span class="s10">return</span><span class="s4"> </span><span class="s13">0</span><span class="s8">;</span><span class="s4"> </span><span class="s1">// Sabbatical ends on DOY 107</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s10">const</span><span class="s1"> currentWeek </span><span class="s8">=</span><span class="s1"> getCalendarWeek</span><span class="s8">(</span><span class="s1">date</span><span class="s8">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s1">// Weeks elapsed = Current Week Number - Sabbatical End Week</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s10">const</span><span class="s1"> elapsedWeeks </span><span class="s8">=</span><span class="s1"> currentWeek </span><span class="s8">-</span><span class="s1"> </span><span class="s11">SABBATICAL_END_WEEK</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s10">return</span><span class="s4"> </span><span class="s1">Math</span><span class="s8">.</span><span class="s4">max</span><span class="s8">(</span><span class="s13">1</span><span class="s8">,</span><span class="s4"> </span><span class="s1">Math</span><span class="s8">.</span><span class="s4">min</span><span class="s8">(</span><span class="s4">elapsedWeeks</span><span class="s8">,</span><span class="s4"> </span><span class="s1">TOTAL_TRACKING_WEEKS</span><span class="s8">));</span></p>
<p class="p9"><span class="s1">};</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s1">// Determines if a date falls within the sabbatical period</span></p>
<p class="p4"><span class="s10">const</span><span class="s1"> isSabbatical </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">date</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> getDayOfYear</span><span class="s8">(</span><span class="s1">date</span><span class="s8">)</span><span class="s1"> </span><span class="s8">&lt;=</span><span class="s1"> </span><span class="s11">DAYS_IN_SABBATICAL</span><span class="s8">;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s1">// Date formatter for display</span></p>
<p class="p4"><span class="s10">const</span><span class="s1"> formatDate </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">date</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> date</span><span class="s8">.</span><span class="s1">toISOString</span><span class="s8">().</span><span class="s1">split</span><span class="s8">(</span><span class="s9">'T'</span><span class="s8">)[</span><span class="s13">0</span><span class="s8">];</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s1">// --- Main Logic Hook ---</span></p>
<p class="p4"><span class="s10">const</span><span class="s1"> useTrackerMetrics </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">dailyLog</span><span class="s8">,</span><span class="s1"> goalDrinksPerWeek</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// TODAY's date, fixed to midnight UTC.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> today </span><span class="s8">=</span><span class="s1"> useMemo</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> now </span><span class="s8">=</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(</span><span class="s11">Date</span><span class="s8">.</span><span class="s11">UTC</span><span class="s8">(</span><span class="s1">now</span><span class="s8">.</span><span class="s1">getFullYear</span><span class="s8">(),</span><span class="s1"> now</span><span class="s8">.</span><span class="s1">getMonth</span><span class="s8">(),</span><span class="s1"> now</span><span class="s8">.</span><span class="s1">getDate</span><span class="s8">()));</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">},</span><span class="s4"> </span><span class="s1">[]);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// Find the latest date with *any* log after the sabbatical ended (Day 107).</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// This is the true end date of the active logging period.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> lastLogDateString </span><span class="s8">=</span><span class="s1"> useMemo</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> loggedDates </span><span class="s8">=</span><span class="s1"> </span><span class="s11">Object</span><span class="s8">.</span><span class="s1">keys</span><span class="s8">(</span><span class="s1">dailyLog</span><span class="s8">).</span><span class="s1">sort</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">let</span><span class="s1"> latestDate </span><span class="s8">=</span><span class="s1"> </span><span class="s10">null</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">for</span><span class="s1"> </span><span class="s8">(</span><span class="s10">const</span><span class="s1"> dateStr </span><span class="s10">of</span><span class="s1"> loggedDates</span><span class="s8">.</span><span class="s1">reverse</span><span class="s8">())</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// IMPORTANT: Parse date as UTC</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">const</span><span class="s1"> date </span><span class="s8">=</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(</span><span class="s1">dateStr </span><span class="s8">+</span><span class="s1"> </span><span class="s9">'T00:00:00Z'</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// We only care about logs *after* the sabbatical</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">isSabbatical</span><span class="s8">(</span><span class="s1">date</span><span class="s8">))</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>latestDate </span><span class="s8">=</span><span class="s1"> dateStr</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s10">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> latestDate</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">[</span><span class="s1">dailyLog</span><span class="s8">]);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// The pacing reference date is the last date logged (or today if no post-sabbatical logs)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> pacingReferenceDate </span><span class="s8">=</span><span class="s1"> useMemo</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">lastLogDateString</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Use the last log date (including 0 drinks) to calculate elapsed weeks for accurate pacing</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">return</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(</span><span class="s1">lastLogDateString </span><span class="s8">+</span><span class="s1"> </span><span class="s9">'T00:00:00Z'</span><span class="s8">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// If no post-sabbatical logs, use today to get correct elapsed weeks (will be 0 if still in sabbatical).</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> today</span><span class="s8">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">[</span><span class="s1">lastLogDateString</span><span class="s8">,</span><span class="s1"> today</span><span class="s8">]);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// Calculate elapsed weeks based on the pacing reference date</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> elapsedTrackingWeeks </span><span class="s8">=</span><span class="s1"> useMemo</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> getElapsedTrackingWeeks</span><span class="s8">(</span><span class="s1">pacingReferenceDate</span><span class="s8">),</span><span class="s1"> </span><span class="s8">[</span><span class="s1">pacingReferenceDate</span><span class="s8">]);</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> metrics </span><span class="s8">=</span><span class="s1"> useMemo</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">let</span><span class="s1"> totalDrinksConsumed </span><span class="s8">=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">let</span><span class="s1"> sabbaticalExceptions </span><span class="s8">=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">let</span><span class="s1"> trackingPeriodDrinks </span><span class="s8">=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Calculate total annual goal based on the current editable value</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> totalGoalDrinksFloat </span><span class="s8">=</span><span class="s1"> goalDrinksPerWeek </span><span class="s8">*</span><span class="s1"> </span><span class="s11">TOTAL_TRACKING_WEEKS</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> totalGoalBottlesFloat </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">totalGoalDrinksFloat </span><span class="s8">*</span><span class="s1"> </span><span class="s11">DRINK_VOLUME_ML</span><span class="s8">)</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> </span><span class="s11">BOTTLE_VOLUME_ML</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Use Math.round for display values</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> totalGoalDrinks </span><span class="s8">=</span><span class="s1"> </span><span class="s11">Math</span><span class="s8">.</span><span class="s1">round</span><span class="s8">(</span><span class="s1">totalGoalDrinksFloat</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> totalGoalBottles </span><span class="s8">=</span><span class="s1"> </span><span class="s11">Math</span><span class="s8">.</span><span class="s1">round</span><span class="s8">(</span><span class="s1">totalGoalBottlesFloat</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Calculate total consumption and exceptions</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">Object</span><span class="s8">.</span><span class="s1">values</span><span class="s8">(</span><span class="s1">dailyLog</span><span class="s8">).</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">entry </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>totalDrinksConsumed </span><span class="s8">+=</span><span class="s1"> entry</span><span class="s8">.</span><span class="s1">drinks</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// IMPORTANT: Parse date as UTC to ensure getDayOfYear is accurate</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">const</span><span class="s1"> date </span><span class="s8">=</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(</span><span class="s1">entry</span><span class="s8">.</span><span class="s1">date </span><span class="s8">+</span><span class="s1"> </span><span class="s9">'T00:00:00Z'</span><span class="s8">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">isSabbatical</span><span class="s8">(</span><span class="s1">date</span><span class="s8">)</span><span class="s1"> </span><span class="s8">&amp;&amp;</span><span class="s1"> entry</span><span class="s8">.</span><span class="s1">drinks </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>sabbaticalExceptions </span><span class="s8">+=</span><span class="s1"> entry</span><span class="s8">.</span><span class="s1">drinks</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Sum drinks only if outside the sabbatical period</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">isSabbatical</span><span class="s8">(</span><span class="s1">date</span><span class="s8">))</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>trackingPeriodDrinks </span><span class="s8">+=</span><span class="s1"> entry</span><span class="s8">.</span><span class="s1">drinks</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Goal Calculation: What should the consumption be *up to this point* based on elapsed time?</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> targetConsumedToDate </span><span class="s8">=</span><span class="s1"> elapsedTrackingWeeks </span><span class="s8">*</span><span class="s1"> goalDrinksPerWeek</span><span class="s8">;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Pacing Calculation ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">let</span><span class="s1"> pacingAvgPerWeek </span><span class="s8">=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">let</span><span class="s1"> totalProjectedDrinks </span><span class="s8">=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">let</span><span class="s1"> bottlesProjected </span><span class="s8">=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">elapsedTrackingWeeks </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Pacing: Average per week (based on elapsed weeks up to the LAST LOG DATE, including 0 logs)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>pacingAvgPerWeek </span><span class="s8">=</span><span class="s1"> round</span><span class="s8">(</span><span class="s1">trackingPeriodDrinks </span><span class="s8">/</span><span class="s1"> elapsedTrackingWeeks</span><span class="s8">);</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Total Projected Drinks for the full 37-week tracking period (BASED ON PACING AVG)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>totalProjectedDrinks </span><span class="s8">=</span><span class="s1"> pacingAvgPerWeek </span><span class="s8">*</span><span class="s1"> </span><span class="s11">TOTAL_TRACKING_WEEKS</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Bottles Drank Projected (Based on current average * over the full tracking period)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>bottlesProjected </span><span class="s8">=</span><span class="s1"> round</span><span class="s8">((</span><span class="s1">totalProjectedDrinks </span><span class="s8">*</span><span class="s1"> </span><span class="s11">DRINK_VOLUME_ML</span><span class="s8">)</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> </span><span class="s11">BOTTLE_VOLUME_ML</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// % of Goal (ANNUAL COUNTDOWN: Actual consumed vs. Total Annual Goal)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> percentOfGoal </span><span class="s8">=</span><span class="s1"> totalGoalDrinks </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">?</span><span class="s1"> round</span><span class="s8">((</span><span class="s1">trackingPeriodDrinks </span><span class="s8">/</span><span class="s1"> totalGoalDrinks</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">100</span><span class="s8">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">:</span><span class="s1"> </span><span class="s8">(</span><span class="s1">trackingPeriodDrinks </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s13">100</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s8">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Drinks on Reserve (Countdown to Annual Goal)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> drinksReserve </span><span class="s8">=</span><span class="s1"> totalGoalDrinks </span><span class="s8">-</span><span class="s1"> trackingPeriodDrinks</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>totalGoalDrinks</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>totalGoalBottles</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>totalDrinksConsumed</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>elapsedTrackingWeeks</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>pacingAvgPerWeek</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>bottlesProjected</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>percentOfGoal</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>drinksOnReserve</span><span class="s8">:</span><span class="s1"> </span><span class="s11">Math</span><span class="s8">.</span><span class="s1">round</span><span class="s8">(</span><span class="s1">drinksReserve</span><span class="s8">),</span><span class="s1"> </span><span class="s12">// ROUNDED TO WHOLE</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>projectedAnnualDrinks</span><span class="s8">:</span><span class="s1"> </span><span class="s11">Math</span><span class="s8">.</span><span class="s1">round</span><span class="s8">(</span><span class="s1">totalProjectedDrinks</span><span class="s8">),</span><span class="s1"> </span><span class="s12">// ROUNDED TO WHOLE</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>sabbaticalExceptions</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>trackingPeriodDrinks</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>targetConsumedToDate</span><span class="s8">:</span><span class="s1"> round</span><span class="s8">(</span><span class="s1">targetConsumedToDate</span><span class="s8">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">};</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">[</span><span class="s1">dailyLog</span><span class="s8">,</span><span class="s1"> elapsedTrackingWeeks</span><span class="s8">,</span><span class="s1"> goalDrinksPerWeek</span><span class="s8">,</span><span class="s1"> lastLogDateString</span><span class="s8">]);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">return</span><span class="s1"> metrics</span><span class="s8">;</span></p>
<p class="p9"><span class="s1">};</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s1">// --- FIREBASE AND AUTHENTICATION ---</span></p>
<p class="p4"><span class="s10">let</span><span class="s1"> firebaseApp</span><span class="s8">,</span><span class="s1"> db</span><span class="s8">,</span><span class="s1"> auth</span><span class="s8">;</span></p>
<p class="p4"><span class="s10">if</span><span class="s1"> </span><span class="s8">(</span><span class="s11">Object</span><span class="s8">.</span><span class="s1">keys</span><span class="s8">(</span><span class="s1">firebaseConfig</span><span class="s8">).</span><span class="s1">length </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>firebaseApp </span><span class="s8">=</span><span class="s1"> initializeApp</span><span class="s8">(</span><span class="s1">firebaseConfig</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>db </span><span class="s8">=</span><span class="s1"> getFirestore</span><span class="s8">(</span><span class="s1">firebaseApp</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>auth </span><span class="s8">=</span><span class="s1"> getAuth</span><span class="s8">(</span><span class="s1">firebaseApp</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">}</span><span class="s1"> </span><span class="s10">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"Firebase initialization failed:"</span><span class="s8">,</span><span class="s4"> e</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">}</span></p>
<p class="p9"><span class="s1">}</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p10"><span class="s1">function</span><span class="s4"> </span><span class="s11">App</span><span class="s8">()</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> </span><span class="s8">[</span><span class="s1">userId</span><span class="s8">,</span><span class="s1"> setUserId</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> useState</span><span class="s8">(</span><span class="s10">null</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> </span><span class="s8">[</span><span class="s1">isAuthReady</span><span class="s8">,</span><span class="s1"> setIsAuthReady</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> useState</span><span class="s8">(</span><span class="s10">false</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> </span><span class="s8">[</span><span class="s1">loading</span><span class="s8">,</span><span class="s1"> setLoading</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> useState</span><span class="s8">(</span><span class="s10">true</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> </span><span class="s8">[</span><span class="s1">dailyLog</span><span class="s8">,</span><span class="s1"> setDailyLog</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> useState</span><span class="s8">({});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// State for the editable goal value (saved in Firestore)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> </span><span class="s8">[</span><span class="s1">goalDrinksPerWeek</span><span class="s8">,</span><span class="s1"> setGoalDrinksPerWeek</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> useState</span><span class="s8">(</span><span class="s11">DEFAULT_GOAL</span><span class="s8">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// State for the input field (used for editing before saving)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> </span><span class="s8">[</span><span class="s1">tempGoalInput</span><span class="s8">,</span><span class="s1"> setTempGoalInput</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> useState</span><span class="s8">(</span><span class="s11">DEFAULT_GOAL</span><span class="s8">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// State for the collapse status</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> </span><span class="s8">[</span><span class="s1">isGoalCollapsed</span><span class="s8">,</span><span class="s1"> setIsGoalCollapsed</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> useState</span><span class="s8">(</span><span class="s10">true</span><span class="s8">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> </span><span class="s8">[</span><span class="s1">selectedDate</span><span class="s8">,</span><span class="s1"> setSelectedDate</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> useState</span><span class="s8">(</span><span class="s1">formatDate</span><span class="s8">(</span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">()));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> </span><span class="s8">[</span><span class="s1">currentDrinks</span><span class="s8">,</span><span class="s1"> setCurrentDrinks</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> useState</span><span class="s8">(</span><span class="s13">0</span><span class="s8">);</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// 1. Firebase Authentication &amp; Setup</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>useEffect</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">auth</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">             </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"Firebase Auth not available."</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span>setLoading</span><span class="s8">(</span><span class="s10">false</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s10">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> setupAuth </span><span class="s8">=</span><span class="s1"> </span><span class="s10">async</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">initialAuthToken</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s10">await</span><span class="s1"> signInWithCustomToken</span><span class="s8">(</span><span class="s1">auth</span><span class="s8">,</span><span class="s1"> initialAuthToken</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s10">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s10">await</span><span class="s1"> signInAnonymously</span><span class="s8">(</span><span class="s1">auth</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s10">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">error</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s9">"Auth error:"</span><span class="s8">,</span><span class="s1"> error</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">};</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> unsubscribe </span><span class="s8">=</span><span class="s1"> onAuthStateChanged</span><span class="s8">(</span><span class="s1">auth</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">user</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">user</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>setUserId</span><span class="s8">(</span><span class="s1">user</span><span class="s8">.</span><span class="s1">uid</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s10">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>setUserId</span><span class="s8">(</span><span class="s10">null</span><span class="s8">);</span><span class="s4"> </span><span class="s1">// Should not happen after setupAuth, but safety check</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setIsAuthReady</span><span class="s8">(</span><span class="s10">true</span><span class="s8">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// NOTE: set loading false is moved to the goal listener to ensure goal is loaded</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>setupAuth</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> unsubscribe</span><span class="s8">();</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">},</span><span class="s4"> </span><span class="s1">[]);</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// 2. Firestore Listener for Goal Settings</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>useEffect</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">isAuthReady </span><span class="s8">||</span><span class="s1"> </span><span class="s8">!</span><span class="s1">userId </span><span class="s8">||</span><span class="s1"> </span><span class="s8">!</span><span class="s1">db</span><span class="s8">)</span><span class="s1"> </span><span class="s10">return</span><span class="s8">;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> goalDocRef </span><span class="s8">=</span><span class="s1"> doc</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/users/</span><span class="s8">${</span><span class="s1">userId</span><span class="s8">}</span><span class="s9">/settings/goals`</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> unsubscribe </span><span class="s8">=</span><span class="s1"> onSnapshot</span><span class="s8">(</span><span class="s1">goalDocRef</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">docSnapshot</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">docSnapshot</span><span class="s8">.</span><span class="s1">exists</span><span class="s8">())</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s10">const</span><span class="s1"> data </span><span class="s8">=</span><span class="s1"> docSnapshot</span><span class="s8">.</span><span class="s1">data</span><span class="s8">();</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Ensure goal is a valid number, default to 1.8 if missing or invalid</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s10">const</span><span class="s1"> newGoal </span><span class="s8">=</span><span class="s1"> parseFloat</span><span class="s8">(</span><span class="s1">data</span><span class="s8">.</span><span class="s1">goalDrinksPerWeek</span><span class="s8">)</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> </span><span class="s11">DEFAULT_GOAL</span><span class="s8">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>setGoalDrinksPerWeek</span><span class="s8">(</span><span class="s1">newGoal</span><span class="s8">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>setTempGoalInput</span><span class="s8">(</span><span class="s4">newGoal</span><span class="s8">);</span><span class="s4"> </span><span class="s1">// Keep input field synced with saved goal</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s10">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// If document doesn't exist, ensure defaults are set</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>setGoalDrinksPerWeek</span><span class="s8">(</span><span class="s11">DEFAULT_GOAL</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>setTempGoalInput</span><span class="s8">(</span><span class="s11">DEFAULT_GOAL</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Now that auth and goal is loaded, we can set loading to false</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setLoading</span><span class="s8">(</span><span class="s10">false</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">(</span><span class="s1">error</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s9">"Error listening to goals:"</span><span class="s8">,</span><span class="s1"> error</span><span class="s8">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span>setLoading</span><span class="s8">(</span><span class="s10">false</span><span class="s8">);</span><span class="s4"> </span><span class="s1">// Stop loading even on error</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> unsubscribe</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">[</span><span class="s1">isAuthReady</span><span class="s8">,</span><span class="s1"> userId</span><span class="s8">]);</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// 3. Firestore Listener for Daily Log</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>useEffect</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">isAuthReady </span><span class="s8">||</span><span class="s1"> </span><span class="s8">!</span><span class="s1">userId </span><span class="s8">||</span><span class="s1"> </span><span class="s8">!</span><span class="s1">db</span><span class="s8">)</span><span class="s1"> </span><span class="s10">return</span><span class="s8">;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> logCollectionRef </span><span class="s8">=</span><span class="s1"> collection</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/users/</span><span class="s8">${</span><span class="s1">userId</span><span class="s8">}</span><span class="s9">/drink_tracker`</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> q </span><span class="s8">=</span><span class="s1"> query</span><span class="s8">(</span><span class="s1">logCollectionRef</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> unsubscribe </span><span class="s8">=</span><span class="s1"> onSnapshot</span><span class="s8">(</span><span class="s1">q</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">snapshot</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">const</span><span class="s1"> newLog </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>snapshot</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">((</span><span class="s1">doc</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s10">const</span><span class="s1"> data </span><span class="s8">=</span><span class="s1"> doc</span><span class="s8">.</span><span class="s1">data</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>newLog</span><span class="s8">[</span><span class="s1">data</span><span class="s8">.</span><span class="s1">date</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> data</span><span class="s8">;</span><span class="s1"> </span><span class="s12">// Key by date for easy lookup</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setDailyLog</span><span class="s8">(</span><span class="s1">newLog</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Re-sync current input if the log for the selected date was just updated</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">const</span><span class="s1"> logEntry </span><span class="s8">=</span><span class="s1"> newLog</span><span class="s8">[</span><span class="s1">selectedDate</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">logEntry</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>setCurrentDrinks</span><span class="s8">(</span><span class="s1">logEntry</span><span class="s8">.</span><span class="s1">drinks</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s10">else</span><span class="s1"> </span><span class="s10">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">newLog</span><span class="s8">[</span><span class="s1">selectedDate</span><span class="s8">])</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>setCurrentDrinks</span><span class="s8">(</span><span class="s13">0</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">(</span><span class="s1">error</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s9">"Error listening to log:"</span><span class="s8">,</span><span class="s1"> error</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> unsubscribe</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">[</span><span class="s1">isAuthReady</span><span class="s8">,</span><span class="s1"> userId</span><span class="s8">,</span><span class="s1"> selectedDate</span><span class="s8">]);</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// Update currentDrinks when selectedDate changes (to reflect past logs)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>useEffect</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> logEntry </span><span class="s8">=</span><span class="s1"> dailyLog</span><span class="s8">[</span><span class="s1">selectedDate</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>setCurrentDrinks</span><span class="s8">(</span><span class="s1">logEntry </span><span class="s8">?</span><span class="s1"> logEntry</span><span class="s8">.</span><span class="s1">drinks </span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">[</span><span class="s1">selectedDate</span><span class="s8">,</span><span class="s1"> dailyLog</span><span class="s8">]);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// --- Data Processing ---</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// Pass the goal to the hook</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> metrics </span><span class="s8">=</span><span class="s1"> useTrackerMetrics</span><span class="s8">(</span><span class="s1">dailyLog</span><span class="s8">,</span><span class="s1"> goalDrinksPerWeek</span><span class="s8">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// --- Actions ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> handleDateChange </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>setSelectedDate</span><span class="s8">(</span><span class="s1">e</span><span class="s8">.</span><span class="s1">target</span><span class="s8">.</span><span class="s1">value</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">};</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> handleIncrement </span><span class="s8">=</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>setCurrentDrinks</span><span class="s8">(</span><span class="s1">prev </span><span class="s8">=&gt;</span><span class="s1"> prev </span><span class="s8">+</span><span class="s1"> </span><span class="s13">1</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">};</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> handleDecrement </span><span class="s8">=</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>setCurrentDrinks</span><span class="s8">(</span><span class="s1">prev </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s11">Math</span><span class="s8">.</span><span class="s1">max</span><span class="s8">(</span><span class="s13">0</span><span class="s8">,</span><span class="s1"> prev </span><span class="s8">-</span><span class="s1"> </span><span class="s13">1</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">};</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> handleSaveLog </span><span class="s8">=</span><span class="s1"> useCallback</span><span class="s8">(</span><span class="s10">async</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">userId </span><span class="s8">||</span><span class="s1"> </span><span class="s8">!</span><span class="s1">db</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"App not ready or DB not available."</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> date </span><span class="s8">=</span><span class="s1"> selectedDate</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> drinks </span><span class="s8">=</span><span class="s1"> currentDrinks</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// setDoc with date as the document ID ensures an OVERWRITE/EDIT, not an add.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> docRef </span><span class="s8">=</span><span class="s1"> doc</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/users/</span><span class="s8">${</span><span class="s1">userId</span><span class="s8">}</span><span class="s9">/drink_tracker/</span><span class="s8">${</span><span class="s1">date</span><span class="s8">}</span><span class="s9">`</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">await</span><span class="s1"> setDoc</span><span class="s8">(</span><span class="s1">docRef</span><span class="s8">,</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>date</span><span class="s8">:</span><span class="s1"> date</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>drinks</span><span class="s8">:</span><span class="s1"> drinks</span><span class="s8">,</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>timestamp</span><span class="s8">:</span><span class="s4"> </span><span class="s10">new</span><span class="s4"> </span><span class="s11">Date</span><span class="s8">(),</span><span class="s4"> </span><span class="s1">// For tracking last modified</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">},</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> merge</span><span class="s8">:</span><span class="s4"> </span><span class="s10">true</span><span class="s4"> </span><span class="s8">});</span><span class="s4"> </span><span class="s1">// Use merge true to prevent overwriting other fields in the future</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s4">log</span><span class="s8">(</span><span class="s1">"Log saved/edited successfully for:"</span><span class="s8">,</span><span class="s4"> date</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span><span class="s1"> </span><span class="s10">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s9">"Error adding document: "</span><span class="s8">,</span><span class="s1"> e</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">[</span><span class="s1">userId</span><span class="s8">,</span><span class="s1"> db</span><span class="s8">,</span><span class="s1"> selectedDate</span><span class="s8">,</span><span class="s1"> currentDrinks</span><span class="s8">]);</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> handleSaveGoal </span><span class="s8">=</span><span class="s1"> useCallback</span><span class="s8">(</span><span class="s10">async</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">userId </span><span class="s8">||</span><span class="s1"> </span><span class="s8">!</span><span class="s1">db</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"App not ready or DB not available."</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> newGoal </span><span class="s8">=</span><span class="s1"> parseFloat</span><span class="s8">(</span><span class="s1">tempGoalInput</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">isNaN</span><span class="s8">(</span><span class="s1">newGoal</span><span class="s8">)</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> newGoal </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s13">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">             </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"Invalid goal input. Must be a non-negative number."</span><span class="s8">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">             </span></span><span class="s1">// In a real app, show a UI error message here</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s10">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> goalDocRef </span><span class="s8">=</span><span class="s1"> doc</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/users/</span><span class="s8">${</span><span class="s1">userId</span><span class="s8">}</span><span class="s9">/settings/goals`</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">await</span><span class="s1"> setDoc</span><span class="s8">(</span><span class="s1">goalDocRef</span><span class="s8">,</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>goalDrinksPerWeek</span><span class="s8">:</span><span class="s1"> round</span><span class="s8">(</span><span class="s1">newGoal</span><span class="s8">),</span><span class="s1"> </span><span class="s12">// Save rounded value</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>lastUpdated</span><span class="s8">:</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(),</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> merge</span><span class="s8">:</span><span class="s1"> </span><span class="s10">true</span><span class="s1"> </span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s1">log</span><span class="s8">(</span><span class="s9">"Goal saved successfully:"</span><span class="s8">,</span><span class="s1"> round</span><span class="s8">(</span><span class="s1">newGoal</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setIsGoalCollapsed</span><span class="s8">(</span><span class="s10">true</span><span class="s8">);</span><span class="s1"> </span><span class="s12">// Collapse after saving</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span><span class="s1"> </span><span class="s10">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s9">"Error saving goal: "</span><span class="s8">,</span><span class="s1"> e</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">[</span><span class="s1">userId</span><span class="s8">,</span><span class="s1"> db</span><span class="s8">,</span><span class="s1"> tempGoalInput</span><span class="s8">]);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// New function to handle data reset (requires getDocs and deleteDoc imports)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> handleResetData </span><span class="s8">=</span><span class="s1"> useCallback</span><span class="s8">(</span><span class="s10">async</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">userId </span><span class="s8">||</span><span class="s1"> </span><span class="s8">!</span><span class="s1">db</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"App not ready or DB not available."</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// 1. Confirm reset (using console log instead of alert/confirm)</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span>console</span><span class="s8">.</span><span class="s4">warn</span><span class="s8">(</span><span class="s1">"Attempting to RESET ALL DATA."</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// 2. Delete all documents in the 'drink_tracker' collection</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> logCollectionRef </span><span class="s8">=</span><span class="s1"> collection</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/users/</span><span class="s8">${</span><span class="s1">userId</span><span class="s8">}</span><span class="s9">/drink_tracker`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">const</span><span class="s1"> snapshot </span><span class="s8">=</span><span class="s1"> </span><span class="s10">await</span><span class="s1"> getDocs</span><span class="s8">(</span><span class="s1">logCollectionRef</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">const</span><span class="s1"> deletePromises </span><span class="s8">=</span><span class="s1"> </span><span class="s8">[];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>snapshot</span><span class="s8">.</span><span class="s1">docs</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">docSnapshot </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>deletePromises</span><span class="s8">.</span><span class="s1">push</span><span class="s8">(</span><span class="s1">deleteDoc</span><span class="s8">(</span><span class="s1">doc</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> logCollectionRef</span><span class="s8">.</span><span class="s1">path</span><span class="s8">,</span><span class="s1"> docSnapshot</span><span class="s8">.</span><span class="s1">id</span><span class="s8">)));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">await</span><span class="s1"> </span><span class="s11">Promise</span><span class="s8">.</span><span class="s1">all</span><span class="s8">(</span><span class="s1">deletePromises</span><span class="s8">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s4">log</span><span class="s8">(</span><span class="s1">"Successfully deleted all drink log documents."</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span><span class="s1"> </span><span class="s10">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"Error deleting documents:"</span><span class="s8">,</span><span class="s4"> e</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// 3. Reset the goal setting to default</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> goalDocRef </span><span class="s8">=</span><span class="s1"> doc</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/users/</span><span class="s8">${</span><span class="s1">userId</span><span class="s8">}</span><span class="s9">/settings/goals`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">await</span><span class="s1"> setDoc</span><span class="s8">(</span><span class="s1">goalDocRef</span><span class="s8">,</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>goalDrinksPerWeek</span><span class="s8">:</span><span class="s1"> </span><span class="s11">DEFAULT_GOAL</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>lastUpdated</span><span class="s8">:</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(),</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s4">log</span><span class="s8">(</span><span class="s1">`Goal reset to default: </span><span class="s8">${</span><span class="s11">DEFAULT_GOAL</span><span class="s8">}</span><span class="s1">`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span><span class="s1"> </span><span class="s10">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s9">"Error resetting goal:"</span><span class="s8">,</span><span class="s1"> e</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">[</span><span class="s1">userId</span><span class="s8">,</span><span class="s1"> db</span><span class="s8">]);</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// --- UI Components ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> </span><span class="s11">MetricCard</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s8">({</span><span class="s1"> title</span><span class="s8">,</span><span class="s1"> value</span><span class="s8">,</span><span class="s1"> unit</span><span class="s8">,</span><span class="s1"> icon</span><span class="s8">:</span><span class="s1"> </span><span class="s11">Icon</span><span class="s8">,</span><span class="s1"> colorClass </span><span class="s8">=</span><span class="s1"> </span><span class="s9">'bg-gray-100'</span><span class="s1"> </span><span class="s8">})</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">(</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">={</span><span class="s1">`p-3 rounded-xl shadow-lg flex flex-col items-center justify-center </span><span class="s8">${</span><span class="s4">colorClass</span><span class="s8">}</span><span class="s1"> text-gray-800 transition duration-300 transform hover:scale-[1.02] border border-opacity-20`</span><span class="s8">}&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">=</span><span class="s1">"flex items-center space-x-1 mb-1"</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s11">Icon</span><span class="s4"> className</span><span class="s8">=</span><span class="s1">"w-4 h-4 text-emerald-600 opacity-80"</span><span class="s4"> /&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">h3 className</span><span class="s8">=</span><span class="s1">"text-[10px] font-semibold uppercase tracking-wider text-gray-500"</span><span class="s8">&gt;{</span><span class="s4">title</span><span class="s8">}&lt;/</span><span class="s4">h3</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s4">p className</span><span class="s8">=</span><span class="s1">"text-xl font-extrabold text-emerald-800"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">{</span><span class="s1">value</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;/</span><span class="s1">p</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s4">unit </span><span class="s8">&amp;&amp;</span><span class="s4"> </span><span class="s8">&lt;</span><span class="s4">span className</span><span class="s8">=</span><span class="s1">"text-[10px] font-medium text-gray-600 mt-0.5"</span><span class="s8">&gt;{</span><span class="s4">unit</span><span class="s8">}&lt;/</span><span class="s4">span</span><span class="s8">&gt;}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// Custom component for the Drinks on Reserve pill</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> </span><span class="s11">ReservePill</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s8">({</span><span class="s1"> value</span><span class="s8">,</span><span class="s1"> unit </span><span class="s8">})</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> isOver </span><span class="s8">=</span><span class="s1"> value </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> sign </span><span class="s8">=</span><span class="s1"> value </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s9">'+'</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s8">(</span><span class="s1">value </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s9">''</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">''</span><span class="s8">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Round to whole number here for display</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> absoluteValue </span><span class="s8">=</span><span class="s1"> </span><span class="s11">Math</span><span class="s8">.</span><span class="s1">abs</span><span class="s8">(</span><span class="s11">Math</span><span class="s8">.</span><span class="s1">round</span><span class="s8">(</span><span class="s1">value</span><span class="s8">));</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> colorClass </span><span class="s8">=</span><span class="s1"> isOver<span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">?</span><span class="s4"> </span><span class="s1">'bg-red-700 text-white shadow-lg shadow-red-400'</span><span class="s4"> </span><span class="s12">// Dark Red for Over</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">:</span><span class="s4"> </span><span class="s1">'bg-emerald-600 text-white shadow-lg shadow-emerald-400'</span><span class="s8">;</span><span class="s4"> </span><span class="s12">// Dark Green for Remaining</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> </span><span class="s8">(</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">={</span><span class="s1">`p-2 rounded-xl flex flex-col items-center justify-center h-full w-full transition duration-300 </span><span class="s8">${</span><span class="s4">colorClass</span><span class="s8">}</span><span class="s1">`</span><span class="s8">}&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">h3 className</span><span class="s8">=</span><span class="s1">"text-[10px] font-semibold uppercase tracking-wider opacity-80 mb-0.5"</span><span class="s8">&gt;</span><span class="s11">Reserve</span><span class="s8">&lt;/</span><span class="s4">h3</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s1">p className</span><span class="s8">=</span><span class="s9">"text-3xl font-extrabold"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1">sign</span><span class="s8">}{</span><span class="s1">absoluteValue</span><span class="s8">}</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">p</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s1">span className</span><span class="s8">=</span><span class="s9">"text-[10px] font-medium opacity-80"</span><span class="s8">&gt;{</span><span class="s1">unit</span><span class="s8">}&lt;/</span><span class="s1">span</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">};</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">loading</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> </span><span class="s8">(</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">=</span><span class="s1">"flex items-center justify-center min-h-screen bg-gray-50"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"text-emerald-600 font-semibold text-lg"</span><span class="s8">&gt;</span><span class="s11">Loading</span><span class="s1"> tracker</span><span class="s8">...&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// IMPORTANT: Create currentDay forcing UTC interpretation to ensure accurate DOY</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> currentDay </span><span class="s8">=</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(</span><span class="s1">selectedDate </span><span class="s8">+</span><span class="s1"> </span><span class="s9">'T00:00:00Z'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> isTodaySabbatical </span><span class="s8">=</span><span class="s1"> isSabbatical</span><span class="s8">(</span><span class="s1">currentDay</span><span class="s8">);</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// Helper function to structure weekly data (Friday to Thursday)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> getWeeklyData </span><span class="s8">=</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> weeks </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">const</span><span class="s1"> dates </span><span class="s8">=</span><span class="s1"> </span><span class="s11">Object</span><span class="s8">.</span><span class="s1">keys</span><span class="s8">(</span><span class="s1">dailyLog</span><span class="s8">).</span><span class="s1">sort</span><span class="s8">();</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>dates</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">dateStr </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// IMPORTANT: Force UTC interpretation</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">const</span><span class="s1"> date </span><span class="s8">=</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(</span><span class="s1">dateStr </span><span class="s8">+</span><span class="s1"> </span><span class="s9">'T00:00:00Z'</span><span class="s8">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Find the start of the week (Friday)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">let</span><span class="s1"> currentDayOfWeek </span><span class="s8">=</span><span class="s1"> date</span><span class="s8">.</span><span class="s1">getUTCDay</span><span class="s8">();</span><span class="s1"> </span><span class="s12">// 0=Sunday, 5=Friday, 6=Saturday</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">let</span><span class="s1"> daysToFriday </span><span class="s8">=</span><span class="s1"> currentDayOfWeek </span><span class="s8">&lt;=</span><span class="s1"> </span><span class="s13">4</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> currentDayOfWeek </span><span class="s8">+</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> currentDayOfWeek </span><span class="s8">-</span><span class="s1"> </span><span class="s13">5</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">const</span><span class="s1"> fridayDate </span><span class="s8">=</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(</span><span class="s1">date</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>fridayDate</span><span class="s8">.</span><span class="s1">setUTCDate</span><span class="s8">(</span><span class="s1">date</span><span class="s8">.</span><span class="s1">getUTCDate</span><span class="s8">()</span><span class="s1"> </span><span class="s8">-</span><span class="s1"> daysToFriday</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s10">const</span><span class="s4"> weekKey </span><span class="s8">=</span><span class="s4"> formatDate</span><span class="s8">(</span><span class="s4">fridayDate</span><span class="s8">);</span><span class="s4"> </span><span class="s1">// Use Friday's date as the week key (YYYY-MM-DD)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">const</span><span class="s1"> calendarWeek </span><span class="s8">=</span><span class="s1"> getCalendarWeek</span><span class="s8">(</span><span class="s1">date</span><span class="s8">);</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">weeks</span><span class="s8">[</span><span class="s1">weekKey</span><span class="s8">])</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>weeks</span><span class="s8">[</span><span class="s1">weekKey</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>startDate</span><span class="s8">:</span><span class="s1"> fridayDate</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>totalDrinks</span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>days</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>calendarWeekNumber</span><span class="s8">:</span><span class="s1"> calendarWeek</span><span class="s8">,</span><span class="s1"> </span><span class="s12">// Continuous week number 1-53</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Determine status based on the first logged date in that week</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>isSabbatical</span><span class="s8">:</span><span class="s1"> isSabbatical</span><span class="s8">(</span><span class="s1">date</span><span class="s8">)</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">const</span><span class="s1"> logEntry </span><span class="s8">=</span><span class="s1"> dailyLog</span><span class="s8">[</span><span class="s1">dateStr</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>weeks</span><span class="s8">[</span><span class="s1">weekKey</span><span class="s8">].</span><span class="s1">totalDrinks </span><span class="s8">+=</span><span class="s1"> logEntry</span><span class="s8">.</span><span class="s1">drinks</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>weeks</span><span class="s8">[</span><span class="s1">weekKey</span><span class="s8">].</span><span class="s1">days</span><span class="s8">[</span><span class="s1">dateStr</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> logEntry</span><span class="s8">.</span><span class="s1">drinks</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> weeks</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">};</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> weeklyData </span><span class="s8">=</span><span class="s1"> getWeeklyData</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">const</span><span class="s1"> sortedWeeks </span><span class="s8">=</span><span class="s1"> </span><span class="s11">Object</span><span class="s8">.</span><span class="s1">keys</span><span class="s8">(</span><span class="s1">weeklyData</span><span class="s8">).</span><span class="s1">sort</span><span class="s8">().</span><span class="s1">reverse</span><span class="s8">();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p10"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s4"> </span><span class="s8">(</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">=</span><span class="s1">"min-h-screen bg-gray-50 font-sans p-4 max-w-lg mx-auto"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s1">script src</span><span class="s8">=</span><span class="s9">"https://cdn.tailwindcss.com"</span><span class="s1">&gt;&lt;/script</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s1">style</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">{</span><span class="s9">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>@import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&amp;display=swap');</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>.font-sans { font-family: 'Inter', sans-serif; }</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;/</span><span class="s1">style</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s4">header className</span><span class="s8">=</span><span class="s1">"py-4 mb-6 border-b border-amber-300"</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">h1 className</span><span class="s8">=</span><span class="s1">"text-2xl font-extrabold text-emerald-800 flex items-center"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s11">Flame</span><span class="s1"> className</span><span class="s8">=</span><span class="s9">"w-6 h-6 mr-2 text-amber-500"</span><span class="s1"> /&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">Sober</span><span class="s8">*</span><span class="s1">ish</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">h1</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">p className</span><span class="s8">=</span><span class="s1">"text-sm text-gray-500 mt-1"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">Tracking</span><span class="s1"> </span><span class="s11">Goal</span><span class="s8">:</span><span class="s1"> </span><span class="s8">**{</span><span class="s1">goalDrinksPerWeek</span><span class="s8">.</span><span class="s1">toFixed</span><span class="s8">(</span><span class="s13">2</span><span class="s8">)}</span><span class="s1"> drinks</span><span class="s8">/</span><span class="s1">week</span><span class="s8">**</span><span class="s1"> </span><span class="s8">({</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">totalGoalDrinks</span><span class="s8">}</span><span class="s1"> annual drinks</span><span class="s8">).</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">p</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">p className</span><span class="s8">=</span><span class="s1">"text-xs text-gray-400 mt-1"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">User</span><span class="s1"> </span><span class="s11">ID</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span><span class="s1">userId</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">p</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;/</span><span class="s1">header</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1">/* GOAL EDITING SECTION */</span><span class="s8">}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s4">section className</span><span class="s8">=</span><span class="s1">"mb-8 p-4 bg-emerald-50 rounded-xl shadow-inner border border-emerald-200"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"flex justify-between items-center cursor-pointer"</span><span class="s1"> onClick</span><span class="s8">={()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> setIsGoalCollapsed</span><span class="s8">(!</span><span class="s1">isGoalCollapsed</span><span class="s8">)}&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s4">h2 className</span><span class="s8">=</span><span class="s1">"text-lg font-bold text-emerald-800 flex items-center"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s11">Goal</span><span class="s1"> className</span><span class="s8">=</span><span class="s9">"w-5 h-5 mr-2 text-emerald-600"</span><span class="s1"> /&gt; </span><span class="s11">Annual</span><span class="s1"> </span><span class="s11">Goal</span><span class="s1"> </span><span class="s11">Setting</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;/</span><span class="s1">h2</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1">isGoalCollapsed </span><span class="s8">?</span><span class="s1"> </span><span class="s8">&lt;</span><span class="s11">ChevronDown</span><span class="s1"> className</span><span class="s8">=</span><span class="s9">"w-5 h-5 text-emerald-600"</span><span class="s1"> /&gt; </span><span class="s8">:</span><span class="s1"> </span><span class="s8">&lt;</span><span class="s11">ChevronUp</span><span class="s1"> className</span><span class="s8">=</span><span class="s9">"w-5 h-5 text-emerald-600"</span><span class="s1"> /&gt;</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">{!</span><span class="s1">isGoalCollapsed </span><span class="s8">&amp;&amp;</span><span class="s1"> </span><span class="s8">(</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">=</span><span class="s1">"mt-4 pt-3 border-t border-emerald-200"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"grid grid-cols-3 gap-4 items-end"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"col-span-2"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;</span><span class="s1">label className</span><span class="s8">=</span><span class="s9">"block text-sm font-medium text-emerald-700 mb-1"</span><span class="s8">&gt;</span><span class="s11">Drinks</span><span class="s1"> </span><span class="s11">Goal</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> </span><span class="s11">Week</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">.</span><span class="s1">g</span><span class="s8">.,</span><span class="s1"> </span><span class="s13">1.8</span><span class="s8">)&lt;/</span><span class="s1">label</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;</span><span class="s1">input</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s10">type</span><span class="s8">=</span><span class="s9">"number"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span>value</span><span class="s8">={</span><span class="s1">tempGoalInput</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span>onChange</span><span class="s8">={(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> setTempGoalInput</span><span class="s8">(</span><span class="s1">e</span><span class="s8">.</span><span class="s1">target</span><span class="s8">.</span><span class="s1">value</span><span class="s8">)}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span>min</span><span class="s8">=</span><span class="s9">"0"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span>step</span><span class="s8">=</span><span class="s9">"0.1"</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                    </span>className</span><span class="s8">=</span><span class="s1">"w-full p-2 border border-emerald-300 rounded-lg shadow-sm focus:ring-emerald-500 focus:border-emerald-500"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span>/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;</span><span class="s1">button</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span>onClick</span><span class="s8">={</span><span class="s1">handleSaveGoal</span><span class="s8">}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                </span>className</span><span class="s8">=</span><span class="s1">"w-full bg-emerald-600 text-white py-2 rounded-lg font-semibold text-sm shadow-md hover:bg-emerald-700 transition duration-150"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s11">Update</span><span class="s1"> </span><span class="s11">Goal</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;/</span><span class="s1">button</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                         </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"mt-6"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;</span><span class="s1">button</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span>onClick</span><span class="s8">={</span><span class="s1">handleResetData</span><span class="s8">}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                </span>className</span><span class="s8">=</span><span class="s1">"w-full flex items-center justify-center bg-gray-200 text-red-600 py-2 rounded-lg font-semibold text-sm shadow-md hover:bg-gray-300 transition duration-150"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;</span><span class="s11">Trash2</span><span class="s1"> className</span><span class="s8">=</span><span class="s9">"w-4 h-4 mr-2"</span><span class="s1"> /&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s11">Reset</span><span class="s1"> </span><span class="s11">All</span><span class="s1"> </span><span class="s11">Data</span><span class="s1"> </span><span class="s8">(</span><span class="s11">Log</span><span class="s1"> </span><span class="s8">&amp;</span><span class="s1"> </span><span class="s11">Goal</span><span class="s8">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;/</span><span class="s1">button</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;</span><span class="s4">p className</span><span class="s8">=</span><span class="s1">"text-xs text-gray-500 mt-2 text-center"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s8">*</span><span class="s11">This</span><span class="s1"> action </span><span class="s10">is</span><span class="s1"> irreversible and clears your log history and resets the goal to </span><span class="s8">{</span><span class="s11">DEFAULT_GOAL</span><span class="s8">}.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;/</span><span class="s1">p</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">)}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;/</span><span class="s1">section</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1">/* Goal Metric Boxes */</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s1">section className</span><span class="s8">=</span><span class="s9">"mb-8"</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">h2 className</span><span class="s8">=</span><span class="s1">"text-xl font-bold mb-4 text-emerald-800"</span><span class="s8">&gt;</span><span class="s11">Annual</span><span class="s4"> </span><span class="s11">Goals</span><span class="s8">&lt;/</span><span class="s4">h2</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"grid grid-cols-3 gap-3"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span></span><span class="s8">&lt;</span><span class="s11">MetricCard</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>title</span><span class="s8">=</span><span class="s9">"Goal / Week"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>value</span><span class="s8">={</span><span class="s1">goalDrinksPerWeek</span><span class="s8">.</span><span class="s1">toFixed</span><span class="s8">(</span><span class="s13">2</span><span class="s8">)}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>icon</span><span class="s8">={</span><span class="s11">Calculator</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>colorClass</span><span class="s8">=</span><span class="s9">"bg-white border border-gray-100"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s11">MetricCard</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>title</span><span class="s8">=</span><span class="s9">"Annual Drinks"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>value</span><span class="s8">={</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">totalGoalDrinks</span><span class="s8">}</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>icon</span><span class="s8">={</span><span class="s11">Goal</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>colorClass</span><span class="s8">=</span><span class="s9">"bg-white border border-gray-100"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s11">MetricCard</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>title</span><span class="s8">=</span><span class="s9">"Annual Bottles"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>value</span><span class="s8">={</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">totalGoalBottles</span><span class="s8">}</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>icon</span><span class="s8">={</span><span class="s11">Wine</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>colorClass</span><span class="s8">=</span><span class="s9">"bg-white border border-gray-100"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;/</span><span class="s1">section</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1">/* Sabbatical Status */</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1">isTodaySabbatical </span><span class="s8">&amp;&amp;</span><span class="s1"> </span><span class="s8">(</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">=</span><span class="s1">"mb-6 p-3 bg-amber-50 border-l-4 border-amber-500 rounded-xl shadow-sm"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s1">p className</span><span class="s8">=</span><span class="s9">"font-bold text-amber-700"</span><span class="s8">&gt;</span><span class="s11">Sabbatical</span><span class="s1"> </span><span class="s11">Period</span><span class="s1"> </span><span class="s11">Active</span><span class="s1"> </span><span class="s8">(</span><span class="s11">Wk</span><span class="s1"> </span><span class="s8">{</span><span class="s1">getCalendarWeek</span><span class="s8">(</span><span class="s1">currentDay</span><span class="s8">)})&lt;/</span><span class="s1">p</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s1">p className</span><span class="s8">=</span><span class="s9">"text-sm text-amber-600"</span><span class="s8">&gt;</span><span class="s11">Encouragement</span><span class="s8">:</span><span class="s1"> </span><span class="s11">You</span><span class="s1"> are </span><span class="s10">in</span><span class="s1"> the first </span><span class="s13">107</span><span class="s1"> days</span><span class="s8">.</span><span class="s1"> </span><span class="s11">Logged</span><span class="s1"> drinks are considered </span><span class="s8">**</span><span class="s11">Exceptions</span><span class="s8">**.&lt;/</span><span class="s1">p</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">)}</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1">/* 1. Daily Input */</span><span class="s8">}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s4">section className</span><span class="s8">=</span><span class="s1">"mb-8 p-4 bg-white rounded-xl shadow-xl"</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">h2 className</span><span class="s8">=</span><span class="s1">"text-lg font-bold mb-4 text-emerald-800"</span><span class="s8">&gt;</span><span class="s11">Log</span><span class="s4"> </span><span class="s11">Daily</span><span class="s4"> </span><span class="s11">Consumption</span><span class="s4"> </span><span class="s8">(</span><span class="s13">1</span><span class="s4"> </span><span class="s11">Drink</span><span class="s4"> </span><span class="s8">=</span><span class="s4"> </span><span class="s13">1</span><span class="s4"> </span><span class="s11">Dram</span><span class="s8">)&lt;/</span><span class="s4">h2</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">=</span><span class="s1">"grid grid-cols-2 gap-4 items-end"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s4">label className</span><span class="s8">=</span><span class="s1">"block text-sm font-medium text-gray-700 mb-1"</span><span class="s8">&gt;</span><span class="s11">Select</span><span class="s4"> </span><span class="s11">Date</span><span class="s8">&lt;/</span><span class="s4">label</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s1">input</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s10">type</span><span class="s8">=</span><span class="s9">"date"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>value</span><span class="s8">={</span><span class="s1">selectedDate</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>onChange</span><span class="s8">={</span><span class="s1">handleDateChange</span><span class="s8">}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                            </span>className</span><span class="s8">=</span><span class="s1">"w-full p-2 border border-gray-300 rounded-lg shadow-sm focus:ring-emerald-500 focus:border-emerald-500"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>max</span><span class="s8">={</span><span class="s1">formatDate</span><span class="s8">(</span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">())}</span><span class="s1"> </span><span class="s12">// Cannot log future dates</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1">/* Dram Input with Buttons */</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"text-center"</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s4">label className</span><span class="s8">=</span><span class="s1">"block text-sm font-medium text-gray-700 mb-1"</span><span class="s8">&gt;</span><span class="s11">Drams</span><span class="s8">/</span><span class="s11">Drinks</span><span class="s4"> </span><span class="s11">Consumed</span><span class="s8">&lt;/</span><span class="s4">label</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">=</span><span class="s1">"flex justify-between items-center space-x-2"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;</span><span class="s1">button</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span>onClick</span><span class="s8">={</span><span class="s1">handleDecrement</span><span class="s8">}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                </span>className</span><span class="s8">=</span><span class="s1">"p-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-full shadow-md transition duration-150 active:bg-gray-400 disabled:opacity-50"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span>disabled</span><span class="s8">={</span><span class="s1">currentDrinks </span><span class="s8">&lt;=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span>aria</span><span class="s8">-</span><span class="s1">label</span><span class="s8">=</span><span class="s9">"Decrement drinks"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;</span><span class="s11">Minus</span><span class="s1"> className</span><span class="s8">=</span><span class="s9">"w-5 h-5"</span><span class="s1"> /&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;/</span><span class="s1">button</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"flex-grow text-center"</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;</span><span class="s4">span className</span><span class="s8">=</span><span class="s1">"text-4xl font-extrabold text-emerald-800 tabular-nums"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s8">{</span><span class="s1">currentDrinks</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;/</span><span class="s1">span</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;</span><span class="s1">button</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span>onClick</span><span class="s8">={</span><span class="s1">handleIncrement</span><span class="s8">}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                </span>className</span><span class="s8">=</span><span class="s1">"p-3 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full shadow-md transition duration-150 active:bg-emerald-700"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span>aria</span><span class="s8">-</span><span class="s1">label</span><span class="s8">=</span><span class="s9">"Increment drinks"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;</span><span class="s11">Plus</span><span class="s1"> className</span><span class="s8">=</span><span class="s9">"w-5 h-5"</span><span class="s1"> /&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;/</span><span class="s1">button</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s1">button</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>onClick</span><span class="s8">={</span><span class="s1">handleSaveLog</span><span class="s8">}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>className</span><span class="s8">=</span><span class="s1">"mt-5 w-full bg-emerald-600 text-white py-3 rounded-xl font-semibold text-lg shadow-lg hover:bg-emerald-700 transition duration-150 transform hover:scale-[1.01]"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1">dailyLog</span><span class="s8">[</span><span class="s1">selectedDate</span><span class="s8">]</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s9">`Overwrite Log with </span><span class="s8">${</span><span class="s1">currentDrinks</span><span class="s8">}</span><span class="s9"> Drinks`</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">`Save </span><span class="s8">${</span><span class="s1">currentDrinks</span><span class="s8">}</span><span class="s9"> Drinks`</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">button</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;/</span><span class="s1">section</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1">/* 2. Pacing Metrics (Redesigned) */</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s1">section className</span><span class="s8">=</span><span class="s9">"mb-8"</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">h2 className</span><span class="s8">=</span><span class="s1">"text-xl font-bold mb-4 text-emerald-800"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">Pacing</span><span class="s1"> </span><span class="s11">Metrics</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">h2</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">{</span><span class="s1">/* Row 1: 3 Pacing Boxes */</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"grid grid-cols-3 gap-3 mb-4"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s11">MetricCard</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>title</span><span class="s8">=</span><span class="s9">"Avg / Week"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>value</span><span class="s8">={</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">pacingAvgPerWeek</span><span class="s8">.</span><span class="s1">toFixed</span><span class="s8">(</span><span class="s13">2</span><span class="s8">)}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>unit</span><span class="s8">={</span><span class="s9">`vs </span><span class="s8">${</span><span class="s1">goalDrinksPerWeek</span><span class="s8">.</span><span class="s1">toFixed</span><span class="s8">(</span><span class="s13">1</span><span class="s8">)}</span><span class="s9"> goal`</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>icon</span><span class="s8">={</span><span class="s11">Calculator</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>colorClass</span><span class="s8">=</span><span class="s9">"bg-gray-100"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s11">MetricCard</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>title</span><span class="s8">=</span><span class="s9">"Bottle Pace"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>value</span><span class="s8">={</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">bottlesProjected</span><span class="s8">.</span><span class="s1">toFixed</span><span class="s8">(</span><span class="s13">2</span><span class="s8">)}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>unit</span><span class="s8">=</span><span class="s9">"Annual Pacing"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>icon</span><span class="s8">={</span><span class="s11">Wine</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>colorClass</span><span class="s8">={</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">bottlesProjected </span><span class="s8">&gt;</span><span class="s1"> metrics</span><span class="s8">.</span><span class="s1">totalGoalBottles </span><span class="s8">?</span><span class="s1"> </span><span class="s9">'bg-red-100'</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'bg-emerald-100'</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s11">MetricCard</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>title</span><span class="s8">=</span><span class="s9">"Total Consumed"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>value</span><span class="s8">={</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">trackingPeriodDrinks</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>unit</span><span class="s8">=</span><span class="s9">""</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>icon</span><span class="s8">={</span><span class="s11">CalendarCheck</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>colorClass</span><span class="s8">=</span><span class="s9">"bg-gray-100"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">{</span><span class="s1">/* Row 2: Progress Bar &amp; Reserve */</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"flex space-x-4 h-24"</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1">/* Progress Bar (3/4 width) */</span><span class="s8">}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">=</span><span class="s1">"w-3/4 bg-white rounded-xl shadow-xl p-4 flex flex-col justify-center border border-gray-200"</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">=</span><span class="s1">"flex justify-between items-center mb-1"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;</span><span class="s1">h3 className</span><span class="s8">=</span><span class="s9">"text-sm font-bold text-gray-700"</span><span class="s8">&gt;</span><span class="s11">Goal</span><span class="s1"> </span><span class="s11">Progress</span><span class="s1"> </span><span class="s8">(</span><span class="s11">Annual</span><span class="s1"> </span><span class="s11">Countdown</span><span class="s8">)&lt;/</span><span class="s1">h3</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;</span><span class="s1">span className</span><span class="s8">={</span><span class="s9">`text-xl font-extrabold </span><span class="s8">${</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">percentOfGoal </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">100</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s9">'text-red-600'</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'text-emerald-600'</span><span class="s8">}</span><span class="s9">`</span><span class="s8">}&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s8">{</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">percentOfGoal</span><span class="s8">.</span><span class="s1">toFixed</span><span class="s8">(</span><span class="s13">1</span><span class="s8">)}%</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;/</span><span class="s1">span</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"w-full bg-gray-200 rounded-full h-3"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;</span><span class="s1">div<span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                </span>className</span><span class="s8">={</span><span class="s1">`h-full rounded-full transition-all duration-500 </span><span class="s8">${</span><span class="s4">metrics</span><span class="s8">.</span><span class="s4">percentOfGoal </span><span class="s8">&gt;</span><span class="s4"> </span><span class="s13">100</span><span class="s4"> </span><span class="s8">?</span><span class="s4"> </span><span class="s1">'bg-red-500'</span><span class="s4"> </span><span class="s8">:</span><span class="s4"> </span><span class="s1">'bg-emerald-500'</span><span class="s8">}</span><span class="s1">`</span><span class="s8">}</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span>style</span><span class="s8">={{</span><span class="s1"> width</span><span class="s8">:</span><span class="s1"> </span><span class="s9">`</span><span class="s8">${</span><span class="s11">Math</span><span class="s8">.</span><span class="s1">min</span><span class="s8">(</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">percentOfGoal</span><span class="s8">,</span><span class="s1"> </span><span class="s13">100</span><span class="s8">)}</span><span class="s9">%`</span><span class="s1"> </span><span class="s8">}}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>&gt;&lt;/div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s1">p className</span><span class="s8">=</span><span class="s9">"text-xs text-gray-500 mt-2"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s11">Consumed</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">trackingPeriodDrinks</span><span class="s8">}</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> </span><span class="s8">{</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">totalGoalDrinks</span><span class="s8">}</span><span class="s1"> drinks</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;/</span><span class="s1">p</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1">/* Reserve Number (1/4 width) */</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s1">div className</span><span class="s8">=</span><span class="s9">"w-1/4"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s11">ReservePill</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>value</span><span class="s8">={</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">drinksOnReserve</span><span class="s8">}</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>unit</span><span class="s8">=</span><span class="s9">"Drinks"</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">{</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">sabbaticalExceptions </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s8">&amp;&amp;</span><span class="s1"> </span><span class="s8">(</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                     </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">=</span><span class="s1">"mt-4 p-3 bg-amber-50 border-l-4 border-amber-500 rounded-xl shadow-sm"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s1">p className</span><span class="s8">=</span><span class="s9">"font-bold text-amber-700"</span><span class="s8">&gt;</span><span class="s11">Sabbatical</span><span class="s1"> </span><span class="s11">Exceptions</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span><span class="s1">metrics</span><span class="s8">.</span><span class="s1">sabbaticalExceptions</span><span class="s8">}</span><span class="s1"> </span><span class="s11">Drinks</span><span class="s8">&lt;/</span><span class="s1">p</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s1">p className</span><span class="s8">=</span><span class="s9">"text-xs text-amber-600"</span><span class="s8">&gt;</span><span class="s11">These</span><span class="s1"> were logged during the first </span><span class="s13">107</span><span class="s1"> days</span><span class="s8">.&lt;/</span><span class="s1">p</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">)}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;/</span><span class="s1">section</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1">/* 4. Weekly Log Table */</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;</span><span class="s1">section className</span><span class="s8">=</span><span class="s9">"mb-8"</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">h2 className</span><span class="s8">=</span><span class="s1">"text-xl font-bold mb-4 text-emerald-800"</span><span class="s8">&gt;</span><span class="s11">Weekly</span><span class="s4"> </span><span class="s11">Log</span><span class="s4"> </span><span class="s8">(</span><span class="s11">Friday</span><span class="s8">-</span><span class="s11">Thursday</span><span class="s8">)&lt;/</span><span class="s4">h2</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;</span><span class="s4">div className</span><span class="s8">=</span><span class="s1">"overflow-x-auto bg-white rounded-xl shadow-xl"</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;</span><span class="s4">table className</span><span class="s8">=</span><span class="s1">"min-w-full divide-y divide-gray-20S00"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s1">thead className</span><span class="s8">=</span><span class="s9">"bg-gray-50"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;</span><span class="s1">tr</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;</span><span class="s4">th className</span><span class="s8">=</span><span class="s1">"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"</span><span class="s8">&gt;</span><span class="s11">Week</span><span class="s4"> </span><span class="s14">#</span><span class="s8">&lt;/</span><span class="s4">th</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;</span><span class="s4">th className</span><span class="s8">=</span><span class="s1">"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"</span><span class="s8">&gt;</span><span class="s11">Period</span><span class="s8">&lt;/</span><span class="s4">th</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;</span><span class="s4">th className</span><span class="s8">=</span><span class="s1">"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"</span><span class="s8">&gt;</span><span class="s11">Drinks</span><span class="s8">&lt;/</span><span class="s4">th</span><span class="s8">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;</span><span class="s4">th className</span><span class="s8">=</span><span class="s1">"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"</span><span class="s8">&gt;</span><span class="s11">Status</span><span class="s8">&lt;/</span><span class="s4">th</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">&lt;/</span><span class="s1">tr</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;/</span><span class="s1">thead</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;</span><span class="s1">tbody className</span><span class="s8">=</span><span class="s9">"bg-white divide-y divide-gray-200"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">{</span><span class="s1">sortedWeeks</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s8">(</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;</span><span class="s1">tr</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s8">&lt;</span><span class="s1">td colSpan</span><span class="s8">=</span><span class="s9">"4"</span><span class="s1"> className</span><span class="s8">=</span><span class="s9">"p-4 text-center text-gray-500 italic"</span><span class="s8">&gt;</span><span class="s11">No</span><span class="s1"> logs found yet</span><span class="s8">.&lt;/</span><span class="s1">td</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s8">&lt;/</span><span class="s1">tr</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">)</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s8">(</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span>sortedWeeks</span><span class="s8">.</span><span class="s1">map</span><span class="s8">((</span><span class="s1">weekKey</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s10">const</span><span class="s1"> week </span><span class="s8">=</span><span class="s1"> weeklyData</span><span class="s8">[</span><span class="s1">weekKey</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s10">const</span><span class="s1"> endDate </span><span class="s8">=</span><span class="s1"> </span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">(</span><span class="s1">week</span><span class="s8">.</span><span class="s1">startDate</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span>endDate</span><span class="s8">.</span><span class="s1">setUTCDate</span><span class="s8">(</span><span class="s1">week</span><span class="s8">.</span><span class="s1">startDate</span><span class="s8">.</span><span class="s1">getUTCDate</span><span class="s8">()</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s13">6</span><span class="s8">);</span><span class="s1"> </span><span class="s12">// Use UTC date setting</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s10">const</span><span class="s1"> isOver </span><span class="s8">=</span><span class="s1"> week</span><span class="s8">.</span><span class="s1">totalDrinks </span><span class="s8">&gt;</span><span class="s1"> goalDrinksPerWeek</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s10">const</span><span class="s1"> isCurrentWeek </span><span class="s8">=</span><span class="s1"> getCalendarWeek</span><span class="s8">(</span><span class="s10">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">())</span><span class="s1"> </span><span class="s8">===</span><span class="s1"> week</span><span class="s8">.</span><span class="s1">calendarWeekNumber</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s10">const</span><span class="s1"> weekLabel </span><span class="s8">=</span><span class="s1"> week</span><span class="s8">.</span><span class="s1">isSabbatical<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s8">?</span><span class="s1"> </span><span class="s9">`Sabbatical Wk </span><span class="s8">${</span><span class="s1">week</span><span class="s8">.</span><span class="s1">calendarWeekNumber</span><span class="s8">}</span><span class="s9">`</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s8">:</span><span class="s1"> </span><span class="s9">`Wk </span><span class="s8">${</span><span class="s1">week</span><span class="s8">.</span><span class="s1">calendarWeekNumber</span><span class="s8">}</span><span class="s9">`</span><span class="s8">;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s10">return</span><span class="s1"> </span><span class="s8">(</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s8">&lt;</span><span class="s1">tr key</span><span class="s8">={</span><span class="s1">weekKey</span><span class="s8">}</span><span class="s1"> className</span><span class="s8">={</span><span class="s9">`transition duration-100 </span><span class="s8">${</span><span class="s1">isCurrentWeek </span><span class="s8">?</span><span class="s1"> </span><span class="s9">'bg-emerald-100 font-semibold'</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'hover:bg-emerald-50'</span><span class="s8">}</span><span class="s9">`</span><span class="s8">}&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s8">&lt;</span><span class="s1">td className</span><span class="s8">=</span><span class="s9">"px-3 py-3 whitespace-nowrap text-sm text-gray-900"</span><span class="s8">&gt;{</span><span class="s1">weekLabel</span><span class="s8">}&lt;/</span><span class="s1">td</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s8">&lt;</span><span class="s1">td className</span><span class="s8">=</span><span class="s9">"px-3 py-3 whitespace-nowrap text-xs text-gray-500"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                                </span></span><span class="s8">{</span><span class="s1">weekKey</span><span class="s8">.</span><span class="s1">slice</span><span class="s8">(</span><span class="s13">5</span><span class="s8">)}</span><span class="s1"> </span><span class="s8">-</span><span class="s1"> </span><span class="s8">{</span><span class="s1">formatDate</span><span class="s8">(</span><span class="s1">endDate</span><span class="s8">).</span><span class="s1">slice</span><span class="s8">(</span><span class="s13">5</span><span class="s8">)}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s8">&lt;/</span><span class="s1">td</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s8">&lt;</span><span class="s1">td className</span><span class="s8">=</span><span class="s9">"px-3 py-3 whitespace-nowrap text-sm text-right"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                                </span></span><span class="s8">&lt;</span><span class="s1">span className</span><span class="s8">={</span><span class="s9">`font-bold </span><span class="s8">${</span><span class="s1">week</span><span class="s8">.</span><span class="s1">totalDrinks </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s8">&amp;&amp;</span><span class="s1"> isOver </span><span class="s8">&amp;&amp;</span><span class="s1"> </span><span class="s8">!</span><span class="s1">week</span><span class="s8">.</span><span class="s1">isSabbatical </span><span class="s8">?</span><span class="s1"> </span><span class="s9">'text-red-600'</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'text-emerald-600'</span><span class="s8">}</span><span class="s9">`</span><span class="s8">}&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                                    </span></span><span class="s8">{</span><span class="s1">week</span><span class="s8">.</span><span class="s1">totalDrinks</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                                </span></span><span class="s8">&lt;/</span><span class="s1">span</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s8">&lt;/</span><span class="s1">td</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s8">&lt;</span><span class="s1">td className</span><span class="s8">=</span><span class="s9">"px-3 py-3 whitespace-nowrap text-sm text-right"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                                </span></span><span class="s8">{</span><span class="s1">week</span><span class="s8">.</span><span class="s1">isSabbatical </span><span class="s8">?</span><span class="s1"> </span><span class="s8">(</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                                    </span></span><span class="s8">&lt;</span><span class="s4">span className</span><span class="s8">=</span><span class="s1">"text-xs font-medium px-2 py-1 rounded-full bg-amber-100 text-amber-800"</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                                        </span></span><span class="s11">Exception</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                                    </span></span><span class="s8">&lt;/</span><span class="s1">span</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                                </span></span><span class="s8">)</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s8">(</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                                                    </span></span><span class="s8">&lt;</span><span class="s4">span className</span><span class="s8">={</span><span class="s1">`text-xs font-medium px-2 py-1 rounded-full </span><span class="s8">${</span><span class="s4">isOver </span><span class="s8">?</span><span class="s4"> </span><span class="s1">'bg-red-100 text-red-800'</span><span class="s4"> </span><span class="s8">:</span><span class="s4"> </span><span class="s1">'bg-emerald-100 text-emerald-800'</span><span class="s8">}</span><span class="s1">`</span><span class="s8">}&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                                        </span></span><span class="s8">{</span><span class="s1">isOver </span><span class="s8">?</span><span class="s1"> </span><span class="s9">'Over Goal'</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'Under Goal'</span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                                    </span></span><span class="s8">&lt;/</span><span class="s1">span</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                                </span></span><span class="s8">)}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s8">&lt;/</span><span class="s1">td</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s8">&lt;/</span><span class="s1">tr</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s8">})</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">)}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">&lt;/</span><span class="s1">tbody</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">&lt;/</span><span class="s1">table</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">&lt;/</span><span class="s1">section</span><span class="s8">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">&lt;/</span><span class="s1">div</span><span class="s8">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s8">);</span></p>
<p class="p9"><span class="s1">}</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p10"><span class="s1">export</span><span class="s4"> </span><span class="s1">default</span><span class="s4"> </span><span class="s11">App</span><span class="s8">;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s7"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- 6. Mount the App --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text/babel"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>import App from "/DrinkTracker.jsx";</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>const root = ReactDOM.createRoot(document.getElementById('root'));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>root.render(&lt;App /&gt;);</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
</body>
</html>
